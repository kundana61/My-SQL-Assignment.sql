                         Assignment-1


Question:

1) Create any 2 tables of your choice.

2) Apply:
1. TIME functions 
2. ROW_NUMBER
3. RANK
4. DENSE_RANK
5. PARTITION_BY
6. FIRST_VALUE
7. PERCENT_RANK
8. All join operations

Queries: 

Table 1 - "Customers"
CREATE TABLE Customers (
    customer_id INT PRIMARY KEY,
    customer_name VARCHAR(50),
    city VARCHAR(50)
);

Table 2 - "Orders"
CREATE TABLE Orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_amount INT,
    order_time TIME,
    FOREIGN KEY (customer_id) REFERENCES Customers(customer_id)
);

Inserting Data into table 1

INSERT INTO Customers VALUES
(1, 'Amit', 'Hyderabad'),
(2, 'Priya', 'Bangalore'),
(3, 'Kiran', 'Chennai'),
(4, 'Neha', 'Delhi');

Inserting Data into table 2

INSERT INTO Orders VALUES
(101, 1, 2000, '10:15:00'),
(102, 2, 5000, '11:30:00'),
(103, 1, 3000, '12:00:00'),
(104, 3, 4000, '09:45:00'),
(105, 2, 2500, '10:00:00');

TIME Functions:

SELECT order_id, order_time, MINUTE(order_time) AS order_minute
FROM Orders;

ROW_NUMBER:

SELECT order_id, order_amount,
ROW_NUMBER() OVER (ORDER BY order_amount DESC) AS row_num
FROM Orders;

RANK:

SELECT order_id, order_amount,
RANK() OVER (ORDER BY order_amount DESC) AS rank_no
FROM Orders;

DENSE_RANK:

SELECT order_id, order_amount,
DENSE_RANK() OVER (ORDER BY order_amount DESC) AS dense_rank_no
FROM Orders;

PARTITION BY:

SELECT customer_id, order_id, order_amount,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_amount DESC) AS customer_order_rank
FROM Orders;

FIRST_VALUE:

SELECT customer_id, order_id, order_amount,
FIRST_VALUE(order_amount) OVER (PARTITION BY customer_id ORDER BY order_amount DESC) AS highest_order
FROM Orders;

PERCENT_RANK:

SELECT order_id, order_amount,
PERCENT_RANK() OVER (ORDER BY order_amount) AS percent_rank
FROM Orders;

All JOIN Operations:

*INNER JOIN:

SELECT c.customer_name, o.order_amount
FROM Customers c
INNER JOIN Orders o ON c.customer_id = o.customer_id;

*LEFT JOIN:

SELECT c.customer_name, o.order_amount
FROM Customers c
LEFT JOIN Orders o ON c.customer_id = o.customer_id;

*RIGHT JOIN:

SELECT c.customer_name, o.order_amount
FROM Customers c
RIGHT JOIN Orders o ON c.customer_id = o.customer_id;

*FULL OUTER JOIN:

SELECT c.customer_name, o.order_amount
FROM Customers c
FULL OUTER JOIN Orders o ON c.customer_id = o.customer_id;
